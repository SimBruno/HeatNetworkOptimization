{
  "hash": "05db190a16c357d827ffc228977fee3a",
  "result": {
    "markdown": "# Process description and analysis\n\nTo provide practical solutions to our industrial partner, the dairy factory, our first task is to show that we truly grasp the problem. To a business manager, industrial processes may seem mysterious and complex, like \"black boxes.\" However, as engineers, we need to dig into the details, using mathematics and physics to analyze and design these industrial processes.\n\nIn this section, your task is to compute the thermodynamic properties of all the streams within each section of the dairy factory. The data collected here will be instrumental in calculating exergy efficiency and energy bills in the following section. To facilitate your work, we have provided an illustrative example for the Pasteurization section below:\n\n## Pasteurisation section\n\n![Pasteurisation](Figures/pasteurisation.svg)\n\nIn this section will be presented the mass and energy balances for each chemical operation of the milk pasteurisation. This pasterisation aims to produce cream and and milk from fresh milk with the intergation of a thickener at some point. \n\n### Mass Flows \n\nBecause of the mass flow conservation, we have:\n\n\\begin{cases}\n\\dot m_{Mixure~Out} = \\dot m_{Past{\\_}Cent} = \\dot m_{Fresh~Milk} = 8~kg/s \\\\\n\n\\dot m_{Milk{\\_}0} = \\dot m_{Past{\\_}a} = \\dot m_{Past{\\_}b} = \\dot m_{Past{\\_}c} =  \\dot m_{Past{\\_}d} = \\dot m_{Milk} = 7.52~kg/s \\\\\n\n\\dot m_{cream{\\_}0} = \\dot m_{crpast{\\_}a} = \\dot m_{Past{\\_}cent} - \\dot m_{Milk{\\_}0} =  \\dot m_{Fresh~Milk} - \\dot m_{Milk} = 8 - 7.52 = 0.48~kg/s ~~ (centrifuge) \\\\\n\n\\dot m_{crpast{\\_}x} = \\dot m_{crpast{\\_}b} = \\dot m_{crpast{\\_}c} = \\dot m_{Cream} =  0.55~kg/s \\\\\n\n\\dot m_{thickener} = 0.07~kg/s \\\\\n\n\\end{cases}\n\nConsequently, all mass flows are defined.\n\n### Heat Capacity\n\nAre already provided the following heat capacity data:\n\n- $c_{p,Raw~Milk} = 3.8 kJ/(kgK)$ (milk after centrifuge)\n\n- $c_{p,Cream~ac} = 3.4 kJ/(kgK)$ (cream after centrifuge)\n\nFrom Litterature [add reference] we chose:\n\n- $c_{p,thickener} = c_{p,albaline} = 0.07 kJ/(kgK)$\n\nAssuming that the mixer provides an ideal mix, we have:\n\n\\begin{align*}\n    c_{p,cream} &= \\frac{\\dot m_{cream{\\_}0}}{\\dot m_{Cream}}.c_{p,Cream~ac} + \\frac{\\dot m_{thickener} }{\\dot m_{Cream}}.c_{p,thickener} \\\\\n    \\\\\n    c_{p,cream} &= \\frac{0.48}{0.55}.3400 + \\frac{0.07}{0.55}.4175 \n\\end{align*}\n\nFinally:\n\n- $c_{p,cream} = 3.5~kJ/(kgK)$\n\n\n\n### Equations of operations \n\n#### Refrigeration\n\n$\\dot Q_{refrigeration} = \\dot m_{Fresh~Milk} . c_{p,Fresh~Milk} . (T_{Fresh~Milk} - T_{Mixure{\\_}out})$\n\n#### PAST1\n\n$\\dot Q_{past~1} = \\dot m_{Fresh~Milk} . c_{p,Fresh~Milk} . (T_{Past{\\_}cent} - T_{Mixure{\\_}out}) = \\dot m_{Milk} . c_{p,Raw~Milk} . (T_{Past{\\_}d} - T_{Past{\\_}c})$\n\n#### TO CONTINUE\n\n::: {.cell}\n\n```{.python .cell-code}\nfrom CoolProp.CoolProp import PropsSI\nrho = PropsSI('D', 'T', 298.15, 'P', 101325, 'Nitrogen')\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# a way to pass the value from python to r is to through json file\nlibrary(reticulate)\nx = 42\n```\n:::\n\n\n\n## Evaporation section\n\n\n::: {.cell}\n\n```{.python .cell-code}\n\nimport pandas as pd\nimport numpy as np\n\nm1=5.0\nm6=m1\nm14=1.6\nm15=1.28\nm16=0.8\n\n\n\ndef fat_increase(m_int1, m_int2, m_int3, m_in = 5.0, p_fat_out3 = 0.50):\n    m_out = m_in - m_int1 - m_int2 - m_int3\n    if m_out < 0:\n        print(\"ERROR: The mass of the output is negative.\")\n    # OUT 3\n    p_water_out3 = 1 - p_fat_out3\n    m_water_out3 = m_out * p_water_out3\n    m_fat = m_out * p_fat_out3\n    # OUT 2\n    m_water_out2 = m_water_out3 + m_int3\n    m_tot_2 = m_water_out2 + m_fat\n    p_fat_out2 = m_fat / m_tot_2\n    p_water_out2 = 1 - p_fat_out2\n    # OUT 1\n    m_water_out1 = m_water_out2 + m_int2\n    m_tot_1 = m_water_out1 + m_fat\n    p_fat_out1 = m_fat / m_tot_1\n    p_water_out1 = 1 - p_fat_out1\n    # OUT 0\n    m_water_out0 = m_water_out1 + m_int1\n    m_tot_0 = m_water_out0 + m_fat\n    p_fat_out0 = m_fat / m_tot_0\n    p_water_out0 = 1 - p_fat_out0\n    if p_water_out0 > 0.883:\n        print(\"WARNING: The water content in the final product is too high.\")\n    return m_out, p_fat_out0, p_fat_out1, p_fat_out2, p_fat_out3, p_water_out0, p_water_out1, p_water_out2, p_water_out3\n\nm11, p_fat_out0, p_fat_out1, p_fat_out2, p_fat_out3, p_water_out0, p_water_out1, p_water_out2, p_water_out3 = fat_increase(m_int1=m14, m_int2=m15, m_int3=m16, m_in = m6, p_fat_out3 = 0.50)\n\n```\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\ndata = {'Point': ['6', '7&8', '9&10', '11'],\n        'Fat content (%)': [p_fat_out0*100, p_fat_out1*100, p_fat_out2*100, p_fat_out3*100],\n        'Water content (%)': [p_water_out0*100, p_water_out1*100, p_water_out2*100, p_water_out3*100]}\ndf = pd.DataFrame(data)\ndf = df.set_index('Point')\ndf = df.round(2)\nprint(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       Fat content (%)  Water content (%)\nPoint                                    \n6                13.20              86.80\n7&8              19.41              80.59\n9&10             31.13              68.87\n11               50.00              50.00\n```\n:::\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\n#Evaporator 1\nfrom codes_01_energy_bill.coolprop_functions import mixture\nfrom pyxosmose.state import State\ndef evaporator_fct(m_in,m_out1,m_out2,h_in,h_out1,h_out2,cp_in,deltaT,hfg):\n    Q_evap = m_in*cp_in*deltaT - m_in*h_in + m_out1*h_out1 + m_out2*h_out2\n    m_w = (Q_evap)/(hfg)\n    return Q_evap, m_w\n#Fixed Parameters \np6=31000\np7=p6\np14=p6\np24=100000\n\nT6=343\nT7=T6\nT14=343\nT24=373 #can be changed if needed to reduce cost instead of having a high pressure\n\n#Dependent Parameters\nState_e6=mixture(T=T6, P=p6, frac_water=p_water_out0, frac_fat=p_fat_out0) # this is a dictionary!!\nprint(State_e6)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n{'fluid': 'water[0.868]&fat[0.132]', 'density': 962.7001054198026, 'cpmass': 3921.5548713530884, 'cvmass': 3651.9680643144657, 'enthalpy': 160898.83620128664, 'entropy': 633.2587328901276}\n```\n:::\n\n```{.python .cell-code}\nh6=State_e6[\"enthalpy\"]\ncp6=State_e6[\"cpmass\"]\n\n\nState_e7=mixture(T=T7, P=p7, frac_water=p_water_out1, frac_fat=p_fat_out1) # this is a dictionary!!\nprint(State_e7)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n{'fluid': 'water[0.8058823529411765]&fat[0.1941176470588235]', 'density': 955.5852572722504, 'cpmass': 3795.165238060788, 'cvmass': 3523.0001011333525, 'enthalpy': 98998.75818603337, 'entropy': 482.65080503506107}\n```\n:::\n\n```{.python .cell-code}\nh7=State_e7[\"enthalpy\"]\n\nPoint_e14 = State(pair='TP', fluid='water', temperature=T14, pressure=p14)\n# Then calculate the state using the State class method StateCalc\nPoint_e14.StateCalc()\n# And print the dictionary for revision\nState_e14 = Point_e14.__dict__ # Whole dictionary with properties\nh14=State_e14[\"enthalpy\"]\nprint(h14)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n292436.50198369997\n```\n:::\n\n```{.python .cell-code}\nPoint_e24 = State(pair='TP', fluid='water', temperature=T24, pressure=p24)\n# Then calculate the state using the State class method StateCalc\nPoint_e24.StateCalc()\n# And print the dictionary for revision\nState_e24 = Point_e24.__dict__ # Whole dictionary with properties\nhfg1=State_e24[\"enthalpy\"]\nprint(hfg1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n2675454.82729398\n```\n:::\n\n```{.python .cell-code}\n#Evap 1 calculation of heat \nm7=m6-m14\ndeltaT=5\n\nQ_evap1, m_w1 = evaporator_fct(m6,m14,m7,h6,h14,h7,cp6,deltaT,hfg1)\n\nprint(Q_evap1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n98038.87178382743\n```\n:::\n\n```{.python .cell-code}\nprint(m_w1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n0.036643815019290135\n```\n:::\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\n#Evaporator 2\n\nfrom codes_01_energy_bill.coolprop_functions import mixture\n\np8=25000\np9=p8\np15=25000\np17=p14\n\nT8=338\nT9=T8\nT15=338\nT17=T14\n\nState_e8=mixture(T=T8, P=p8, frac_water=p_water_out2, frac_fat=p_fat_out2) # this is a dictionary!!\nprint(State_e8)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n{'fluid': 'water[0.6886792452830188]&fat[0.3113207547169811]', 'density': 945.1653329497142, 'cpmass': 3552.918021132332, 'cvmass': 3294.625255566396, 'enthalpy': -35572.67843746964, 'entropy': 146.2888570265397}\n```\n:::\n\n```{.python .cell-code}\nh8=State_e8[\"enthalpy\"]\ncp8=State_e8[\"cpmass\"]\n\nState_e9=mixture(T=T9, P=p9, frac_water=p_water_out2, frac_fat=p_fat_out2) # this is a dictionary!!\nprint(State_e9)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n{'fluid': 'water[0.6886792452830188]&fat[0.3113207547169811]', 'density': 945.1653329497142, 'cpmass': 3552.918021132332, 'cvmass': 3294.625255566396, 'enthalpy': -35572.67843746964, 'entropy': 146.2888570265397}\n```\n:::\n\n```{.python .cell-code}\nh9=State_e9[\"enthalpy\"]\n\nPoint_e15 = State(pair='TP', fluid='water', temperature=T15, pressure=p15)\n# Then calculate the state using the State class method StateCalc\nPoint_e15.StateCalc()\n# And print the dictionary for revision\nState_e15 = Point_e15.__dict__ # Whole dictionary with properties\nh15=State_e15[\"enthalpy\"]\nprint(h15)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n271487.85437864583\n```\n:::\n\n```{.python .cell-code}\nPoint_e17 = State(pair='TP', fluid='water', temperature=T17, pressure=p17)\n# Then calculate the state using the State class method StateCalc\nPoint_e17.StateCalc()\n# And print the dictionary for revision\nState_e17 = Point_e17.__dict__ # Whole dictionary with properties\nhfg2=State_e17[\"enthalpy\"]\nprint(hfg2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n292436.50198369997\n```\n:::\n\n```{.python .cell-code}\nm8=m7\nm9=m8-m15\ndeltaT=5\n\nQ_evap2, m_w2 = evaporator_fct(m8,m15,m9,h8,h15,h9,cp8,deltaT,hfg2)\n\nprint(Q_evap2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n453437.08836387744\n```\n:::\n\n```{.python .cell-code}\nprint(m_w2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n1.5505488722784389\n```\n:::\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\n#Evaporator 3\n\nfrom codes_01_energy_bill.coolprop_functions import mixture\n\n\np10=20000\np11=p10\np15=25000\np18=p15\np16=20000\n\n\nT10=333\nT11=T10\nT15=338\nT18=T15\nT16=333\n\nState_e10=mixture(T=T10, P=p10, frac_water=p_water_out2, frac_fat=p_fat_out2) # this is a dictionary!!\nprint(State_e10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n{'fluid': 'water[0.6886792452830188]&fat[0.3113207547169811]', 'density': 948.0781658589956, 'cpmass': 3549.5254120297204, 'cvmass': 3309.434970198847, 'enthalpy': -53332.80452343682, 'entropy': 93.36744199486805}\n```\n:::\n\n```{.python .cell-code}\nh10=State_e10[\"enthalpy\"]\ncp10=State_e10[\"cpmass\"]\n\nState_e11=mixture(T=T11, P=p11, frac_water=p_water_out3, frac_fat=p_fat_out3) # this is a dictionary!!\nprint(State_e11)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n{'fluid': 'water[0.5]&fat[0.5]', 'density': 926.7695716453064, 'cpmass': 3164.347670344805, 'cvmass': 2904.598689734579, 'enthalpy': -237505.7961777266, 'entropy': -352.7179398999766}\n```\n:::\n\n```{.python .cell-code}\nh11=State_e11[\"enthalpy\"]\n\nPoint_e16 = State(pair='TP', fluid='water', temperature=T16, pressure=p16)\n# Then calculate the state using the State class method StateCalc\nPoint_e16.StateCalc()\n# And print the dictionary for revision\nState_e16 = Point_e16.__dict__ # Whole dictionary with properties\nh16=State_e16[\"enthalpy\"]\nprint(h16)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n250552.63170614128\n```\n:::\n\n```{.python .cell-code}\nPoint_e18 = State(pair='TP', fluid='water', temperature=T18, pressure=p18)\n# Then calculate the state using the State class method StateCalc\nPoint_e18.StateCalc()\n# And print the dictionary for revision\nState_e18 = Point_e18.__dict__ # Whole dictionary with properties\nhfg3=State_e18[\"enthalpy\"]\nprint(hfg3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n271487.85437864583\n```\n:::\n\n```{.python .cell-code}\nm10=m9\nm11=m10-m16\ndeltaT=5\n\nQ_evap3, m_w3 = evaporator_fct(m10,m16,m11,h10,h16,h11,cp10,deltaT,hfg3)\n\nprint(Q_evap3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n37624.969367515005\n```\n:::\n\n```{.python .cell-code}\nprint(m_w3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n0.1385880390621056\n```\n:::\n:::\n\n\n\n\n## Process 3\n\n...\n\n",
    "supporting": [
      "02.00-process_description_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}